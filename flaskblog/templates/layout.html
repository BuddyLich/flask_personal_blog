<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    {% if title %}
        <title>{{ title }}</title>
    {% else %}
         <title>没撒子技术含量的学习笔记</title>
    {% endif %}
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.1/styles/vs2015.min.css">

</head>
<style>

body::-webkit-scrollbar {
  width: 5px;
}

body::-webkit-scrollbar-track {
  background: #f1f1f1;
}

body::-webkit-scrollbar-thumb {
  background: #888;
}

body::-webkit-scrollbar-thumb:hover {
  background: #555;
}

nav::-webkit-scrollbar {
  width: 5px;
}

nav::-webkit-scrollbar-track {
  background: florawhite;
}

nav::-webkit-scrollbar-thumb {
  background: DimGrey;
}

nav::-webkit-scrollbar-thumb:hover {
  background: grey;
    }
}
</style>
<body>
    <header class="site-header">
      <nav class="navbar navbar-expand-md navbar-dark bg-steel fixed-top">
        <div>
            <button type="button" id="sidebarCollapse" class="btn btn-secondary">
                <i class="fas fa-align-left"></i>
            </button>
        </div>
          <div class="container-fluid">
          <a class="navbar-brand mr-4" style="float: left;text-align:left;" href="/">没撒子技术含量的学习笔记</a>
          <div class="collapse navbar-collapse" id="navbarToggle">
            <div class="navbar-nav mr-auto">
            </div>
            <!-- Navbar Right Side -->
            <div class="navbar-nav">
                {% if current_user.is_authenticated %}
                <a class="nav-item nav-link" href="{{ url_for('posts.new_post') }}">New Post</a>
                <a class="nav-item nav-link" href="{{ url_for('users.account') }}">Account</a>
                <a class="nav-item nav-link" href="{{ url_for('users.logout') }}">Logout</a>
                {% endif %}
            <form class="form-inline my-2 my-lg-0" action="{{ url_for('main.search') }}">
              <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="keyword">
              <button class="btn btn-outline-light my-2 my-sm-0" type="submit">搜索笔记</button>
            </form>
            </div>
          </div>
        </div>
      </nav>
    </header>
    <div class="wrapper">
    <div id="keep-sidebar-space">
    </div>
    <nav id="sidebar" style="position:fixed; overflow: scroll;">
        <div class="sidebar-header">
            <img class="rounded-circle profile-img" width="100px" src="{{ url_for('static', filename='profile_pics/profile_pic.jpeg') }}"/>
        </div>
        <ul class="lisst-unstyled components">
            <li class="nav-bar-shadow">
                <a href="/">首页</a>
            </li>
            <li class="nav-bar-shadow">
                <a href="#categorySubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">文章类别</a>
            <ul class="collapse list-unstyled" id="categorySubmenu">
                {% if current_user.is_authenticated %}
                    <li class="nav-bar-shadow">
                        <a href="{{ url_for('categories.new_category') }}">+ 新类别</a>
                    </li>
                {% endif %}
                {% for category in categories_sorted_by_sequence %}
                    <li class="nav-bar-shadow">
                        <a href="{{ url_for('categories.category', category_id=category.id) }}">{{ category.name }}</a>
                    </li>
                {% endfor %}
            </ul>
        </li>
        <li class="nav-bar-shadow">
            <a href="{{ url_for('main.about') }}">关于</a>
        </li>
        <li class="nav-bar-shadow">
            <a href="{{ url_for('main.future_feature') }}">待完成功能</a>
        </li>
    </ul>
    </nav>


    <div id="content">
        <div class="col-md-8 content">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}

        </div>
        <div class="col-sm-3 sidebar-right-position" style="position:fixed;">
          <div class="content-sidebar">
            <h3 >最近的笔记</h3>
              <ul class="list-group">
                {% for post in recent_posts %}
                  <li class="list-group-item list-group-item-light" style="color:DimGrey;font-weight:normal;">{{ post.date_posted.strftime('%d-%m-%Y') }}<br>
                  <a href="{{ url_for('posts.post', post_id=post.id) }}" style="color:DimGrey;font-weight:bold">{{ post.title }}</a>
                {% endfor %}
              </ul>
            <br>
              {% if current_user.is_authenticated  %}
                  <div class="row text-center" style="border-top: 0.5px solid #DCDCDC;">
                    <div class="col">
                        <div class="counter">
                            <i class="fa fa-desktop fa-2x " style="color:dimgrey"></i>
                            <h2 class="timer count-title count-number" data-to="{{ access_count }}" data-speed="1500"></h2>
                            <p class="count-text ">来访人数</p>
                        </div>
                    </div>
                </div>
                <div style="border-top: 0.5px solid #DCDCDC; text-align: center;">
                    <a href="https://www.facebook.com/zhen.zheng.5876/"><img width='22%' style="margin:8px" src="{{ url_for('static', filename='contact_icons/facebook.png') }}"/></a>
                    <a href="https://github.com/BuddyLich"><img width='22%' style="margin:8px" src="{{ url_for('static', filename='contact_icons/github.png') }}"/></a>
                    <a href="mailto:zhengzhen048@gmail.com"><img width='22%' style="margin:8px" src="{{ url_for('static', filename='contact_icons/gmail.webp') }}"/></a>
                </div>
              {% else %}
                <div style="text-align: center;">
                    <a href="https://www.facebook.com/zhen.zheng.5876/"><img width='22%' style="margin:8px" src="{{ url_for('static', filename='contact_icons/facebook.png') }}"/></a>
                    <a href="https://github.com/BuddyLich"><img width='22%' style="margin:8px" src="{{ url_for('static', filename='contact_icons/github.png') }}"/></a>
                    <a href="mailto:zhengzhen048@gmail.com"><img width='22%' style="margin:8px" src="{{ url_for('static', filename='contact_icons/gmail.webp') }}"/></a>
                </div>
              {% endif %}

            </div>

            </ul>
          </div>
        </div>
        </div>
        </div>
</div>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script>

$(document).ready(function () {
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').toggleClass('active');
                $('#keep-sidebar-space').toggleClass('active');
            });
        });

(function ($) {
	$.fn.countTo = function (options) {
		options = options || {};

		return $(this).each(function () {
			// set options for current element
			var settings = $.extend({}, $.fn.countTo.defaults, {
				from:            $(this).data('from'),
				to:              $(this).data('to'),
				speed:           $(this).data('speed'),
				refreshInterval: $(this).data('refresh-interval'),
				decimals:        $(this).data('decimals')
			}, options);

			// how many times to update the value, and how much to increment the value on each update
			var loops = Math.ceil(settings.speed / settings.refreshInterval),
				increment = (settings.to - settings.from) / loops;

			// references & variables that will change with each update
			var self = this,
				$self = $(this),
				loopCount = 0,
				value = settings.from,
				data = $self.data('countTo') || {};

			$self.data('countTo', data);

			// if an existing interval can be found, clear it first
			if (data.interval) {
				clearInterval(data.interval);
			}
			data.interval = setInterval(updateTimer, settings.refreshInterval);

			// initialize the element with the starting value
			render(value);

			function updateTimer() {
				value += increment;
				loopCount++;

				render(value);

				if (typeof(settings.onUpdate) == 'function') {
					settings.onUpdate.call(self, value);
				}

				if (loopCount >= loops) {
					// remove the interval
					$self.removeData('countTo');
					clearInterval(data.interval);
					value = settings.to;

					if (typeof(settings.onComplete) == 'function') {
						settings.onComplete.call(self, value);
					}
				}
			}

			function render(value) {
				var formattedValue = settings.formatter.call(self, value, settings);
				$self.html(formattedValue);
			}
		});
	};

	$.fn.countTo.defaults = {
		from: 0,               // the number the element should start at
		to: 0,                 // the number the element should end at
		speed: 1000,           // how long it should take to count between the target numbers
		refreshInterval: 100,  // how often the element should be updated
		decimals: 0,           // the number of decimal places to show
		formatter: formatter,  // handler for formatting the value before rendering
		onUpdate: null,        // callback method for every time the element is updated
		onComplete: null       // callback method for when the element finishes updating
	};

	function formatter(value, settings) {
		return value.toFixed(settings.decimals);
	}
}(jQuery));

jQuery(function ($) {
  // custom formatting example
  $('.count-number').data('countToOptions', {
	formatter: function (value, options) {
	  return value.toFixed(options.decimals).replace(/\B(?=(?:\d{3})+(?!\d))/g, ',');
	}
  });

  // start all the timers
  $('.timer').each(count);

  function count(options) {
	var $this = $(this);
	options = $.extend({}, options || {}, $this.data('countToOptions') || {});
	$this.countTo(options);
  }
});
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</body>
</html>
